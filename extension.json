{"id":"ruirize_volume","title":"Volume","css":".audio_controls .progress_container {\n\twidth: 93%;\n}\n\n.ruirize-volume {\n\tposition: absolute;\n\tright: 0;\n\ttop: 0;\n\tbottom: 0;\n\twidth: 7%;\n\tborder-left: 1px solid RGBA(0,0,0,0.14902);\n\tcursor: pointer;\n}\n.ruirize-volume:active {\n\tcursor: url('/images/closedhand.cur'),move!important;\n\tcursor: -webkit-grabbing!important;\n\tcursor: -moz-grabbing!important;\n}\n\n.ruirize-current-volume {\n\tposition: absolute;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tborder-top: 1px solid RGBA(0,0,0,0.14902);\n\tbackground: rgba(0,0,0,0.05);\n\tpointer-events: none;\n}\n\n.ruirize-volume-cursor {\n\tposition: absolute;\n\tleft: 0;\n\tright: 0;\n\theight: 1px;\n\tbackground: RGBA(0,0,0,0.14902);\n\ttransition: opacity 0.3s;\n\topacity: 0;\n\tpointer-events: none;\n}\n\n.ruirize-volume:hover .ruirize-volume-cursor {\n\topacity: 1;\n}","script":"//* TITLE Volume **//\n//* VERSION 1.0 REV A **//\n//* DESCRIPTION Adds volume controls next to all Tumblr-hosted audio posts. **//\n//* DEVELOPER ruirize **//\n//* FRAME false **//\n//* BETA false **//\n\nXKit.extensions.ruirize_volume = new Object({\n\trunning: false,\n\trun: function() {\n\t\tXKit.tools.init_css(\"ruirize_volume\");\n\t\tXKit.post_listener.add(\"ruirize_volume\", XKit.extensions.ruirize_volume.addVolumeControls);\n\n\t\tXKit.extensions.ruirize_volume.addVolumeControls();\n\t},\n\tdestroy: function() {\n\t\tXKit.tools.remove_css(\"ruirize_volume\");\n\t\t$(\"ruirize-volume\").remove();\n\t\t$(\"ruirize-volume-setup\").removeClass(\"ruirize-volume-setup\");\n\t\t$(\"ruirize-volume-loaded\").removeClass(\"ruirize-volume-loaded\");\n\t},\n\n\taddVolumeControls: function() {\n\t\tvar posts = XKit.interface.get_posts(\"ruirize-volume-setup\", false);\n\t\t$(posts).each(function(index) {\n\t\t\t$(this).addClass(\"ruirize-volume-setup\");\n\t\t\tvar currentPost = XKit.interface.post($(this));\n\t\t\tif (currentPost.type != \"audio\") return;\n\n\t\t\tvar thisPost = $(this);\n\t\t\t$(this).find(\".post_content_inner\").get(0).addEventListener(\"DOMNodeInserted\", function (ev) {\n\t\t\t\tconsole.log(ev.target);\n\t\t\t\tif ($(ev.target).prop(\"tagName\") == \"AUDIO\" && !thisPost.hasClass(\"ruirize-volume-loaded\")) {\n\t\t\t\t\tXKit.extensions.ruirize_volume.constructVolumeControl(thisPost);\n\t\t\t\t\tthisPost.addClass(\"ruirize-volume-loaded\");\n\t\t\t\t}\n\t\t\t}, false);\n\t\t});\n\t},\n\n\tconstructVolumeControl: function(post) {\n\t\tvar volumeControl = $(('<div class=\"ruirize-volume\"><div class=\"ruirize-current-volume\"></div><div class=\"ruirize-volume-cursor\"></div></div>'))\n\t\t\t.appendTo(post.find('.audio_controls'));\n\t\tvar audioElement = post.find('audio');\n\t\tconsole.log(audioElement);\n\n\t\tvar isMouseDown = false;\n\t\tvolumeControl.mousemove(function(ev){\n\t\t\t$(this).children(\".ruirize-volume-cursor\").css(\"top\", ev.offsetY + \"px\");\n\n\t\t\tif (isMouseDown) {\n\t\t\t\tvar volume = 1 - (ev.offsetY / $(this).height());\n\t\t\t\tXKit.extensions.ruirize_volume.updateVolume(volume, volumeControl, audioElement);\n\t\t\t}\n\t\t});\n\n\t\tvolumeControl.mousedown(function(ev){\n\t\t\tif (ev.button !== 0) return;\n\t\t\t\n\t\t\tisMouseDown = true;\n\n\t\t\tvar volume = 1 - (ev.offsetY / $(this).height());\n\t\t\tXKit.extensions.ruirize_volume.updateVolume(volume, volumeControl, audioElement);\n\t\t});\n\n\t\tvolumeControl.mouseup(function(ev){\n\t\t\tisMouseDown = false;\n\t\t});\n\t\tvolumeControl.mouseout(function(ev){\n\t\t\tisMouseDown = false;\n\t\t});\n\t\tvolumeControl.bind('dragstart', function(event) { event.preventDefault(); });\n\t\t\n\t\tvar initialVolume = XKit.extensions.ruirize_volume.readCookie(\"ruirize-volume-preference\");\n\t\tif (initialVolume == null) {\n\t\t\tinitialVolume = 0.8\n\t\t}\n\t\tXKit.extensions.ruirize_volume.updateVolume(initialVolume, volumeControl, audioElement);\n\t},\n\n\tupdateVolume: function(volume, volumeControlElement, audioElement) {\n\t\tvolumeControlElement.children(\".ruirize-current-volume\").height(volume * volumeControlElement.height());\n\t\taudioElement.prop(\"volume\", volume);\n\t\tXKit.extensions.ruirize_volume.createCookie(\"ruirize-volume-preference\", volume, 365);\n\t},\n\t\n\treadCookie: function(name) {\n\t\tvar nameEQ = name + \"=\";\n\t\tvar ca = document.cookie.split(';');\n\t\tfor(var i=0;i < ca.length;i++) {\n\t\t\tvar c = ca[i];\n\t\t\twhile (c.charAt(0)==' ') c = c.substring(1,c.length);\n\t\t\tif (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n\t\t}\n\t\treturn null;\n\t},\n\tcreateCookie: function(name,value,days) {\n\t\tif (days) {\n\t\t\tvar date = new Date();\n\t\t\tdate.setTime(date.getTime()+(days*24*60*60*1000));\n\t\t\tvar expires = \"; expires=\"+date.toGMTString();\n\t\t}\n\t\telse var expires = \"\";\n\t\tdocument.cookie = name+\"=\"+value+expires+\"; path=/\";\n\t}\n});","icon":"data:image/png;base64,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","description":"Adds volume controls next to all Tumblr-hosted audio posts.","developer":"ruirize","version":"1.0 REV A","errors":false,"beta":false,"frame":false,"details":""}